@inherits LayoutComponentBase
@inject NavigationManager Navigation
@inject BlazorWeb.Services.ApiService ApiService

<MudThemeProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="1">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" />
        <MudText Typo="Typo.h5" Class="ml-3">Serverless Starter</MudText>
        <MudSpacer />
        @if (ApiService.IsAuthenticated)
        {
            <MudButton Color="Color.Inherit" OnClick="Logout">Logout</MudButton>
        }
        else
        {
            <MudButton Color="Color.Inherit" Href="/login">Login</MudButton>
            <MudButton Color="Color.Primary" Variant="Variant.Filled" Href="/register">Register</MudButton>
        }
    </MudAppBar>
    <MudDrawer Open="true" Elevation="2">
        <MudDrawerHeader>
            <MudText Typo="Typo.h6">Menu</MudText>
        </MudDrawerHeader>
        <MudNavMenu>
            <MudNavLink Href="/" Icon="@Icons.Material.Filled.Home">Home</MudNavLink>
            <MudNavLink Href="/products" Icon="@Icons.Material.Filled.ShoppingCart">Products</MudNavLink>
        </MudNavMenu>
    </MudDrawer>
    <MudMainContent Class="mt-16 pa-4">
        @Body
    </MudMainContent>
</MudLayout>

@code {
    private void Logout()
    {
        ApiService.Logout();
        Navigation.NavigateTo("/");
    }
}
